# 要件定義書

## 機能要件

要求定義に基づき、本アプリケーションは以下の機能要件を満たす。

### 画面一覧

アプリケーションは、以下の主要な画面で構成される。

*   トップページ
    *   新規でルームを作成する際、同時にプレイヤー名を入力し、ルーム作成とゲーム参加を一連の操作で行える機能。
    *   既存ルームへの参加（URLからの直接アクセスが主）。

*   ゲーム待機画面（ロビー）
    *   参加者が一覧で表示される
    *   ルームのURLをコピーする機能
    *   ホスト（ルーム作成者）がゲームを開始するボタン

*   お題入力画面
    *   親：お題（単語）、本当の意味、および任意で参考にした辞書サイトなどのURLを入力する。
    *   子：親がお題を入力し終えるまで、待機画面（例：「親がお題を入力中です…」）を表示する。

*   意味入力画面
    *   全員：親が入力したお題が表示される。
    *   子：お題に対する「もっともらしい偽の意味」をテキストボックスに入力し、送信する。
    *   親：子の意味入力が完了するまで待機する。

*   投票画面
    *   お題が表示される
    *   「本当の意味」と、子たちが作った「偽の意味」がシャッフルされ、選択肢として表示される
    *   子は、正解だと思う選択肢と、ベットする点数（1〜3点）を選んで投票する

*   結果発表画面
    *   正解の選択肢を発表する
    *   誰がどの選択肢に投票したかを表示する
    *   各選択肢の作成者を発表する
    *   このラウンドでの点数の増減を反映した結果を表示する

*   最終結果画面
    *   全ラウンド終了後、プレイヤー全員の最終的な順位と持ち点を表示する

### ゲーム進行・採点ルール

本ゲームは、以下のルールに基づいて進行および採点を行う。

#### 1. ゲーム設定
*   プレイヤー人数: 3人以上、8人以下
*   初期持ち点: 各プレイヤー10点
*   親の選出:
    *   最初の親は、ルームを作成したホストが担当する。
    *   次のラウンド以降の親は、ルームに入室した順番で担当する。
*   ゲーム終了条件: 参加者全員が一度ずつ親を経験した時点でゲーム終了となる。

#### 2. 点数計算ルール

各ラウンドの結果発表時に、以下のルールで点数を計算する。

*   **子が「本当の意味」に投票した場合（正解）**:
    *   子は親から、ベットした点数を受け取る。
    *   例：子が3点ベットして正解した場合、子は `+3`点、親は `-3`点。

*   **子が「偽の意味」に投票した場合（不正解）**:
    *   子は、投票先の「偽の意味」の作者にベットした点数を支払う。
    *   さらに、子は親に1点を支払う。
    *   例：プレイヤーAがプレイヤーB作の偽の意味に2点ベットした場合、Aは計3点失い(Bに2点、親に1点)、Bは `+2`点、親は `+1`点。

*   **全員が不正解だった場合（親への特別ボーナス）**:
    *   上記ルールとは別に、親は子全員から追加で1点ずつ受け取る。
    *   例：子が3人いる場合、このボーナスだけで親は `+3`点、子はそれぞれ `-1`点。

### 共通UI要件

ゲームプレイ中の主要な画面（待機、入力、投票、結果など）には、常に以下の情報を表示する共通領域を設ける。

* 参加者一覧: 現在ルームに参加しているプレイヤーの名前を一覧表示する。
* 点数状況: 各プレイヤーの現在の持ち点を一覧表示する。
* ゲームログ: ゲームの進行状況がリアルタイムで表示される。
    *   （例: 「Aさんが参加しました」「親はBさんです」「Cさんは意味の入力を完了しました」「Dさんは2番の選択肢に3点をベットしました」など）

## 非機能要件（検討中）

*   お題データ管理:
    *   将来的な拡張として、プレイヤーが入力したお題（単語、意味、参考URL）をデータベースに蓄積し、親が「自分で入力」または「データベースから取得」を選択できるようにする機能を検討する。
